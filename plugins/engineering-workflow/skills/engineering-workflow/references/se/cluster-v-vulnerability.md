# SE Vulnerability Cluster Reference

> Reference material for agents V-1, V-2, V-3, V-4

## Table of Contents

| Section | Agent | Line Range |
|---------|-------|------------|
| Threat Modeling Methodologies | v1-threat-modeler | 20-110 |
| OWASP Top 10 Checklist | v2-owasp-auditor | 111-220 |
| Penetration Testing | v3-pentest-strategist | 221-290 |
| Supply Chain Security | v4-supply-chain-auditor | 291-350 |

---

<!-- SECTION:v1-threat-modeler:START -->

## 1. Threat Modeling Methodologies

### 1.1 STRIDE

STRIDE is a per-element threat classification model developed by Microsoft.
Apply it to every element in a Data Flow Diagram (DFD): processes, data stores,
data flows, external entities, and trust boundaries.

#### STRIDE Categories

| Category | Threat | Property Violated | Example |
|----------|--------|-------------------|---------|
| **S**poofing | Pretending to be someone else | Authentication | Forged JWT, session hijacking |
| **T**ampering | Modifying data or code | Integrity | SQL injection, man-in-the-middle |
| **R**epudiation | Denying actions performed | Non-repudiation | Missing audit logs, unsigned transactions |
| **I**nformation Disclosure | Exposing data to unauthorized parties | Confidentiality | Error stack traces, directory listing |
| **D**enial of Service | Making the system unavailable | Availability | Resource exhaustion, algorithmic complexity attacks |
| **E**levation of Privilege | Gaining unauthorized access levels | Authorization | IDOR, privilege escalation via role manipulation |

#### DFD Trust Boundary Identification

```
+--------------------------------------------------+
| Trust Boundary: Internet                          |
|  [Browser]                                        |
+----------|---------------------------------------+
           | HTTPS
+----------|---------------------------------------+
| Trust Boundary: DMZ                               |
|  (WAF) -> (API Gateway)                          |
+----------|---------------------------------------+
           | mTLS
+----------|---------------------------------------+
| Trust Boundary: Internal Network                  |
|  (Order Service) -> (Payment Service)            |
|        |                     |                    |
|  [Order DB]           [Payment DB]               |
+--------------------------------------------------+
```

#### Threat-to-Mitigation Mapping

| STRIDE | DFD Element | Threat Example | Mitigation |
|--------|------------|----------------|------------|
| Spoofing | External Entity -> Process | Forged API key | mTLS, OAuth2 client credentials |
| Tampering | Data Flow | Modified request payload | TLS, request signing (HMAC) |
| Repudiation | Process | Admin denies deleting records | Immutable audit log, hash chain |
| Info Disclosure | Data Store | Database dump via SQLi | Parameterized queries, encryption at rest |
| DoS | Process | CPU exhaustion via ReDoS | Regex timeout, input length limits |
| EoP | Process | Horizontal privilege escalation | Resource-level authorization checks |

### 1.2 PASTA (Process for Attack Simulation and Threat Analysis)

PASTA is a 7-stage, risk-centric threat modeling methodology that
aligns business objectives with technical threat analysis.

| Stage | Activity | Output |
|-------|----------|--------|
| 1. Define Objectives | Identify business impact, compliance requirements | Business impact analysis |
| 2. Define Technical Scope | Document architecture, technologies, dependencies | Architecture diagram, tech stack |
| 3. Application Decomposition | Create DFDs, identify trust boundaries, data classification | DFD Level 0-2, data flow matrix |
| 4. Threat Analysis | Research threat landscape, gather intelligence | Threat intelligence report |
| 5. Vulnerability Analysis | Map vulnerabilities to components, scan results | Vulnerability matrix |
| 6. Attack Modeling | Build attack trees, simulate attack paths | Attack trees, kill chains |
| 7. Risk & Impact | Score risks, prioritize remediation | Risk register, remediation roadmap |

### 1.3 Attack Trees

Attack trees decompose a high-level attacker goal into sub-goals
connected by AND/OR nodes with cost and difficulty annotations.

```
[ROOT] Steal User Credentials
├── [OR] Phishing Attack ($: Low, Skill: Low)
│   ├── [AND] Craft convincing email
│   └── [AND] Set up credential harvesting page
├── [OR] Exploit Authentication Vulnerability ($: Medium, Skill: Medium)
│   ├── [OR] Brute-force weak passwords
│   ├── [OR] Credential stuffing from breach data
│   └── [OR] Session fixation attack
├── [OR] Intercept Network Traffic ($: Medium, Skill: High)
│   ├── [AND] Perform MITM on unencrypted traffic
│   └── [AND] SSL stripping attack
└── [OR] Compromise Server ($: High, Skill: High)
    ├── [OR] Exploit RCE vulnerability
    ├── [OR] SQL injection to dump credential table
    └── [OR] Insider threat (malicious admin)
```

### 1.4 Risk Scoring

#### DREAD Model

| Factor | Question | Score (1-10) |
|--------|----------|-------------|
| **D**amage | How severe is the impact? | 1 (minimal) - 10 (complete compromise) |
| **R**eproducibility | How easy to reproduce? | 1 (very hard) - 10 (always) |
| **E**xploitability | How much skill/tooling needed? | 1 (expert + custom tools) - 10 (script kiddie) |
| **A**ffected Users | How many users impacted? | 1 (single user) - 10 (all users) |
| **D**iscoverability | How easy to find? | 1 (nearly impossible) - 10 (obvious) |

Risk = (D + R + E + A + D) / 5

#### CVSS v3.1 Base Score Components

| Metric Group | Metric | Values |
|-------------|--------|--------|
| Exploitability | Attack Vector (AV) | Network / Adjacent / Local / Physical |
| | Attack Complexity (AC) | Low / High |
| | Privileges Required (PR) | None / Low / High |
| | User Interaction (UI) | None / Required |
| Impact | Confidentiality (C) | None / Low / High |
| | Integrity (I) | None / Low / High |
| | Availability (A) | None / Low / High |
| | Scope (S) | Unchanged / Changed |

#### Risk Matrix

| | Impact: Low | Impact: Medium | Impact: High | Impact: Critical |
|---|---|---|---|---|
| **Likelihood: High** | Medium | High | Critical | Critical |
| **Likelihood: Medium** | Low | Medium | High | Critical |
| **Likelihood: Low** | Low | Low | Medium | High |
| **Likelihood: Very Low** | Info | Low | Low | Medium |

<!-- SECTION:v1-threat-modeler:END -->
<!-- SECTION:v2-owasp-auditor:START -->

## 2. OWASP Top 10 (2021) Checklist

### A01: Broken Access Control

**Description**: Restrictions on authenticated users are not properly enforced.

**Common Vulnerabilities**:
- Insecure Direct Object References (IDOR)
- Missing function-level access control
- CORS misconfiguration allowing unauthorized access
- Metadata manipulation (JWT claims, cookies, hidden fields)

**Detection**: Authorization testing at every endpoint, automated access control matrix verification.

**Remediation**:
```kotlin
// Resource-level authorization check
@PreAuthorize("@authService.isOwner(#orderId, authentication.principal.id)")
@GetMapping("/orders/{orderId}")
fun getOrder(@PathVariable orderId: Long): OrderResponse {
    return orderService.findById(orderId)
}
```

### A02: Cryptographic Failures

**Description**: Failures related to cryptography leading to sensitive data exposure.

**Common Vulnerabilities**:
- Data transmitted in cleartext (HTTP, SMTP, FTP)
- Weak or deprecated algorithms (MD5, SHA1, DES, RC4)
- Default or hardcoded cryptographic keys
- Missing encryption at rest for sensitive data

**Detection**: TLS configuration scanning, code review for crypto patterns, secret scanning.

**Remediation**:
```kotlin
// Use strong algorithms with proper key management
val cipher = Cipher.getInstance("AES/GCM/NoPadding")
val key = keyManagementService.getKey("data-encryption-key") // From Vault/KMS
val iv = SecureRandom().let { ByteArray(12).also(it::nextBytes) }
cipher.init(Cipher.ENCRYPT_MODE, key, GCMParameterSpec(128, iv))
```

### A03: Injection

**Description**: User-supplied data is sent to an interpreter without validation/sanitization.

**Common Vulnerabilities**: SQL injection, NoSQL injection, OS command injection, LDAP injection, Expression Language injection.

**Remediation**: Parameterized queries, ORM frameworks, input validation, allow-listing.

### A04: Insecure Design

**Description**: Architectural and design flaws that cannot be fixed by implementation alone.

**Common Vulnerabilities**: Missing threat modeling, no rate limiting on sensitive flows, trust boundary violations, missing business logic validation.

**Remediation**: Threat modeling during design phase, secure design patterns, abuse case testing.

### A05: Security Misconfiguration

**Description**: Missing hardening, default configurations, verbose error messages.

**Common Vulnerabilities**:
- Default credentials on admin panels
- Unnecessary features enabled (directory listing, debug endpoints)
- Missing security headers
- Overly permissive cloud IAM policies
- Stack traces in production error responses

**Detection**: Configuration scanning (CIS benchmarks), automated hardening verification.

**Remediation**:
```yaml
# Spring Boot production hardening
server:
  error:
    include-stacktrace: never
    include-message: never
  servlet:
    session:
      cookie:
        http-only: true
        secure: true
        same-site: strict
management:
  endpoints:
    web:
      exposure:
        include: health,info  # Minimal actuator exposure
  endpoint:
    health:
      show-details: never
```

### A06: Vulnerable and Outdated Components

**Description**: Using libraries, frameworks, or components with known vulnerabilities.

**Detection**: SCA tools (Snyk, Trivy, Dependabot), SBOM generation and monitoring.

**Remediation**: Automated dependency updates, version pinning, security advisory monitoring.

### A07: Identification and Authentication Failures

**Description**: Weaknesses in authentication mechanisms.

**Common Vulnerabilities**: Credential stuffing, brute force, weak passwords, missing MFA, session fixation, insecure "remember me".

**Remediation**:
```kotlin
@Configuration
class AuthSecurityConfig {
    @Bean
    fun passwordEncoder(): PasswordEncoder = BCryptPasswordEncoder(12)

    @Bean
    fun authenticationManager(config: AuthenticationConfiguration) =
        config.authenticationManager

    // Rate limiting on auth endpoints
    @Bean
    fun loginRateLimiter() = RedisRateLimiter(5, 10) // 5 requests/sec, burst 10
}
```

### A08: Software and Data Integrity Failures

**Description**: Code and infrastructure without integrity verification.

**Common Vulnerabilities**: Unsigned CI/CD pipelines, auto-update without verification, insecure deserialization, compromised dependencies.

**Remediation**: Digital signatures on artifacts, SLSA provenance, SRI for CDN resources, deserialization allow-lists.

### A09: Security Logging and Monitoring Failures

**Description**: Insufficient logging makes detection, escalation, and forensics difficult.

**Common Vulnerabilities**: Auditable events not logged, logs not monitored, missing alerting, no incident response plan.

**Remediation**: Log authentication events, access control failures, input validation failures, high-value transactions. Send to SIEM with real-time alerting.

### A10: Server-Side Request Forgery (SSRF)

**Description**: Application fetches a remote resource without validating the user-supplied URL.

**Common Vulnerabilities**: URL parameter to internal services, PDF generators fetching URLs, webhook callbacks.

**Remediation**:
```kotlin
fun validateUrl(url: String): URI {
    val uri = URI.create(url)

    // Block internal networks
    val host = InetAddress.getByName(uri.host)
    require(!host.isLoopbackAddress) { "Loopback addresses blocked" }
    require(!host.isSiteLocalAddress) { "Private addresses blocked" }
    require(!host.isLinkLocalAddress) { "Link-local addresses blocked" }

    // Allow only HTTPS
    require(uri.scheme == "https") { "Only HTTPS allowed" }

    // Allow-list of permitted domains
    require(uri.host in ALLOWED_DOMAINS) { "Domain not in allow-list" }

    return uri
}
```

### OWASP Verification Checklist

| Category | Check | Tool | Severity |
|----------|-------|------|----------|
| A01 | IDOR testing on all endpoints | Burp Authorize, manual | Critical |
| A01 | CORS configuration review | curl, browser DevTools | High |
| A02 | TLS configuration (grade A+) | SSL Labs, testssl.sh | Critical |
| A02 | No hardcoded secrets in code | gitleaks, detect-secrets | Critical |
| A03 | SQL injection testing | sqlmap, Burp Scanner | Critical |
| A03 | Command injection testing | Commix, manual | Critical |
| A05 | Security headers present | securityheaders.com, curl | Medium |
| A05 | Debug endpoints disabled | Nuclei, manual | High |
| A06 | No known CVEs in dependencies | Trivy, Snyk | High |
| A07 | Brute-force protection on login | Hydra, manual | High |
| A07 | MFA enabled for admin accounts | Manual verification | Critical |
| A09 | Security events logged | Log review, SIEM query | High |
| A10 | SSRF testing on URL parameters | Burp Collaborator, manual | High |

<!-- SECTION:v2-owasp-auditor:END -->
<!-- SECTION:v3-pentest-strategist:START -->

## 3. Penetration Testing

### 3.1 Methodology Comparison

| Methodology | Focus | Phases | Best For |
|------------|-------|--------|----------|
| OWASP Testing Guide v4 | Web applications | 11 categories, 91 test cases | Web app security testing |
| PTES (Penetration Testing Execution Standard) | General | 7 phases (pre-engagement through reporting) | Full-scope engagements |
| OSSTMM (Open Source Security Testing Methodology Manual) | Operational security | 6 channels (Human, Physical, Wireless, Telecom, Data Networks, Compliance) | Compliance-driven testing |
| NIST SP 800-115 | Technical assessment | Planning, Discovery, Attack, Reporting | Government/regulated |
| CREST | Professional standard | Preparation, Intelligence, Vulnerability, Exploitation, Post-exploitation, Reporting | Third-party assurance |

### 3.2 Tool Matrix

| Category | Tool | Purpose | License |
|----------|------|---------|---------|
| **Proxy** | Burp Suite Professional | Interactive web app testing, scanner | Commercial |
| **Proxy** | OWASP ZAP | Automated scanning + manual testing | Open source |
| **SAST** | Semgrep | Code-level vulnerability patterns | Open source (Community) |
| **SAST** | SonarQube | Continuous code quality + security | Community/Commercial |
| **DAST** | Nuclei | Template-based known CVE scanning | Open source |
| **DAST** | Nikto | Web server scanner | Open source |
| **Recon** | Amass | Subdomain enumeration | Open source |
| **Recon** | Shodan | Internet-wide scanning, service fingerprinting | Freemium |
| **API** | Postman / Newman | API testing, collection runner | Freemium |
| **API** | Dredd | API contract testing | Open source |
| **Container** | Trivy | Container image vulnerability scanning | Open source |
| **Container** | Grype | SBOM-based vulnerability scanning | Open source |
| **Secret** | gitleaks | Git secret scanning | Open source |
| **Secret** | TruffleHog | Credential scanning in repos and S3 | Open source |
| **Exploit** | Metasploit | Exploitation framework | Open source (Community) |
| **Network** | Nmap | Port scanning, service detection | Open source |

### 3.3 Scope Definition Template

```yaml
engagement:
  type: web_application_pentest  # web, api, mobile, network, cloud
  methodology: OWASP_Testing_Guide_v4
  duration: "5 business days"
  report_deadline: "10 business days after testing complete"

scope:
  in_scope:
    - "https://app.example.com (production - read-only testing)"
    - "https://staging.example.com (full testing)"
    - "https://api.example.com/v2/** (all API endpoints)"
    - "Mobile app (iOS/Android, latest version)"

  out_of_scope:
    - "Third-party integrations (Stripe, SendGrid)"
    - "Physical security"
    - "Social engineering"
    - "DDoS testing"
    - "Production database modification"

  rules_of_engagement:
    - "No automated scanning on production during business hours (09:00-18:00 KST)"
    - "Staging environment: full automated + manual testing allowed"
    - "Stop testing immediately if data breach suspected"
    - "Use test accounts only (provided by client)"
    - "No persistence mechanisms (backdoors, C2)"

  testing_windows:
    production: "weekdays 22:00-06:00 KST, weekends anytime"
    staging: "anytime"

  emergency_contacts:
    - name: "Security Team Lead"
      phone: "+82-10-XXXX-XXXX"
      email: "security@example.com"
    - name: "DevOps On-Call"
      phone: "+82-10-XXXX-XXXX"
      escalation: "PagerDuty"

  evidence_handling:
    - "All findings documented with proof-of-concept"
    - "Screenshots and HTTP request/response pairs"
    - "No customer data extracted beyond proof-of-concept"
    - "All evidence encrypted (AES-256) and deleted 30 days after report delivery"
    - "Testing traffic tagged with X-Pentest-ID header for log correlation"
```

<!-- SECTION:v3-pentest-strategist:END -->
<!-- SECTION:v4-supply-chain-auditor:START -->

## 4. Supply Chain Security

### 4.1 SBOM Formats

| Feature | CycloneDX | SPDX |
|---------|-----------|------|
| Focus | Application security | License compliance (originated from Linux Foundation) |
| Format | JSON, XML, Protobuf | JSON, RDF, tag-value, YAML |
| Component Types | Libraries, frameworks, services, firmware, containers | Packages, files, snippets |
| Vulnerability Support | VEX (Vulnerability Exploitability eXchange) integrated | External VEX document |
| Adoption | OWASP, security-focused | ISO/IEC 5962:2021, compliance-focused |
| Generation Tools | `syft`, `cdxgen`, `trivy sbom` | `syft`, `scancode-toolkit` |

#### SBOM Generation (CI/CD)

```yaml
# GitHub Actions: generate SBOM on every build
- name: Generate SBOM
  uses: anchore/sbom-action@v0
  with:
    format: cyclonedx-json
    output-file: sbom.cdx.json
    image: ${{ env.IMAGE_NAME }}:${{ github.sha }}

- name: Scan SBOM for vulnerabilities
  run: |
    grype sbom:sbom.cdx.json --fail-on high
```

### 4.2 SCA (Software Composition Analysis) Tools

| Tool | Strengths | Weaknesses | Pricing |
|------|-----------|------------|---------|
| Snyk | Developer-friendly, fix PRs, broad language support | Cost at scale | Free tier + commercial |
| Dependabot | Native GitHub integration, automatic PRs | GitHub-only, limited policy controls | Free (GitHub) |
| Trivy | Fast, multi-target (image, filesystem, SBOM), CI-friendly | No managed dashboard | Open source |
| Grype | SBOM-based scanning, fast | CLI-only, no PR integration | Open source |
| Renovate | Highly configurable, self-hosted option | Complex configuration | Open source |
| OWASP Dependency-Check | NIST NVD integration, mature | Slow scans, high false positives | Open source |

#### Severity Thresholds for Build Gates

```yaml
# .trivyignore or trivy policy
vulnerability:
  severity:
    - CRITICAL   # Always block
    - HIGH       # Block unless accepted in VEX
  ignore_unfixed: true

# Build gate configuration
gates:
  dev:
    block_on: [CRITICAL]
    warn_on: [HIGH]
  staging:
    block_on: [CRITICAL, HIGH]
    warn_on: [MEDIUM]
  production:
    block_on: [CRITICAL, HIGH]
    warn_on: [MEDIUM, LOW]
    max_age_days: 30   # Block if fix available for >30 days
```

### 4.3 SLSA Framework (Supply-chain Levels for Software Artifacts)

| Level | Requirements | Trust |
|-------|-------------|-------|
| SLSA 1 | Build process exists and produces provenance | Documentation only |
| SLSA 2 | Version-controlled build service, authenticated provenance | Tamper-resistant after build |
| SLSA 3 | Hardened build platform, non-falsifiable provenance | Resistant to insider threats |
| SLSA 4 | Two-person review, hermetic builds, reproducible | Highest assurance |

#### Build Provenance with Sigstore

```yaml
# GitHub Actions: SLSA 3 provenance
- name: Build and push image
  uses: docker/build-push-action@v5
  with:
    push: true
    tags: ghcr.io/org/app:${{ github.sha }}

- name: Generate SLSA provenance
  uses: slsa-framework/slsa-github-generator/.github/workflows/generator_container_slsa3.yml@v1
  with:
    image: ghcr.io/org/app
    digest: ${{ steps.build.outputs.digest }}

- name: Sign with cosign
  run: |
    cosign sign --yes \
      --key env://COSIGN_PRIVATE_KEY \
      ghcr.io/org/app@${{ steps.build.outputs.digest }}

- name: Verify signature
  run: |
    cosign verify \
      --key env://COSIGN_PUBLIC_KEY \
      ghcr.io/org/app@${{ steps.build.outputs.digest }}
```

#### in-toto Attestation

```json
{
  "_type": "https://in-toto.io/Statement/v0.1",
  "subject": [{
    "name": "ghcr.io/org/app",
    "digest": {"sha256": "abc123..."}
  }],
  "predicateType": "https://slsa.dev/provenance/v0.2",
  "predicate": {
    "builder": {"id": "https://github.com/slsa-framework/slsa-github-generator"},
    "buildType": "https://github.com/slsa-framework/slsa-github-generator/container@v1",
    "invocation": {
      "configSource": {
        "uri": "git+https://github.com/org/app@refs/heads/main",
        "digest": {"sha1": "def456..."},
        "entryPoint": ".github/workflows/release.yml"
      }
    },
    "materials": [
      {"uri": "git+https://github.com/org/app", "digest": {"sha1": "def456..."}}
    ]
  }
}
```

### 4.4 License Compliance

#### License Categories

| Category | Licenses | Risk Level | Policy |
|----------|----------|-----------|--------|
| Permissive | MIT, Apache 2.0, BSD-2, BSD-3, ISC | Low | Auto-approve |
| Weak copyleft | LGPL-2.1, MPL-2.0, EPL-2.0 | Medium | Review required (dynamic linking usually OK) |
| Strong copyleft | GPL-2.0, GPL-3.0 | High | Block for proprietary software |
| Network copyleft | AGPL-3.0 | Critical | Block for SaaS applications |
| Unknown / Custom | Unlicensed, custom terms | Critical | Manual legal review required |

#### License Compatibility Matrix

| Outbound License | MIT | Apache 2.0 | LGPL 2.1 | GPL 3.0 | AGPL 3.0 |
|-----------------|-----|-----------|----------|---------|----------|
| **MIT (inbound)** | OK | OK | OK | OK | OK |
| **Apache 2.0** | OK | OK | OK | OK (with patent grant) | OK |
| **LGPL 2.1** | NO | NO | OK | OK | OK |
| **GPL 3.0** | NO | NO | NO | OK | OK |
| **AGPL 3.0** | NO | NO | NO | NO | OK |

#### Automated License Policy

```yaml
# .licensefinder.yml or equivalent SCA config
license_policy:
  approved:
    - MIT
    - Apache-2.0
    - BSD-2-Clause
    - BSD-3-Clause
    - ISC
    - CC0-1.0
    - Unlicense

  review_required:
    - LGPL-2.1-only
    - LGPL-3.0-only
    - MPL-2.0
    - EPL-2.0

  denied:
    - GPL-2.0-only
    - GPL-3.0-only
    - AGPL-3.0-only
    - SSPL-1.0
    - BSL-1.1

  unknown_action: deny  # Block unlicensed dependencies

  exceptions:
    - package: "linux-headers"
      license: "GPL-2.0"
      reason: "System dependency, not linked into application"
    - package: "gcc-runtime"
      license: "GPL-3.0 with GCC Runtime Library Exception"
      reason: "Runtime exception permits proprietary use"
```
<!-- SECTION:v4-supply-chain-auditor:END -->
